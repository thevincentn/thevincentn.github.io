function loadAdaptiveQuiz(e,t,n=null){iatData[t]={quizDataUrl:e,quizData:null,parentElement:null,pageElements:{questionArea:null,progressArea:null,heading:null,questionPoolName:null,questionHtml:null,buttonZone:null,progressBar:null,strikeZone:null,nextButton:null,previousButton:null,restartButton:null,showFeedbackButton:null},sessionData:{currentPageType:null,currentQuestion:null,currentPool:null,highestLevelAchieved:0,highestPoolAchieved:null,quizEndReason:null,feedbackReportQuestions:[]},specialPages:{PRE_QUIZ:null,POST_QUIZ:null,UPGRADE_FEEDBACK:null,DOWNGRADE_FEEDBACK:null,MULTIPLE_CHOICE:null,MULTI_SELECT:null,FILL_IN_THE_BLANK:null,MATCHING:null},replaceStrings:["#{quizName}","#{currentPool}","#{upgradePool}","#{downgradePool}","#{numRemainingToUpgrade}","#{numRemainingToDowngrade}","#{endingLevel}","#{highestLevelAchieved}"],langTerms:{nextButton:"Continue",previousButton:"Previous",restartButton:"Restart Quiz",checkAnswerButton:"Check Answer",showFeedbackButton:"Show My Answers",hintButton:'<span class="icon hint" aria-label="Toggle Hint"></span>',strikeZoneText:"You have #{numRemainingToDowngrade} remaining before going to the lower level.",progressBarText:"You have #{numRemainingToUpgrade} remaining before progressing to the next level."}},iatData[t].parentElement=document.getElementById(t),iatData[t].parentElement.classList.add("aiq");const s=function(){loadQuizData(e,t,function(){loadLanguageData(t,function(){initializeQuiz(t)})},n)};"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?s():document.addEventListener("DOMContentLoaded",s)}function initializeQuiz(e){let t=iatData[e];t.giveIds=function(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=t,t++)},t.createHintBoxElem=function(){const e=document.createElement("div");return e.classList.add("hint-box"),e.id="hint-box",e.setAttribute("role","region"),e.setAttribute("aria-live","polite"),e.show=function(){this.classList.remove("hidden"),this.removeAttribute("aria-hidden")},e.hide=function(){this.classList.add("hidden"),this.setAttribute("aria-hidden","true")},e.toggle=function(){this.classList.contains("hidden")?this.show():this.hide()},e.setContent=function(e){this.innerHTML=e},t.pageElements.hintBox=e,e},t.createProgressBarElem=function(e=!1){const n=document.createElement("div");n.classList.add("progress-bar-container");const s=document.createElement("div");return s.classList.add("progress-bar"),s.setAttribute("role","progressbar"),s.setAttribute("aria-valuemin","0"),s.setAttribute("aria-live","assertive"),s.overall=e,t.pageElements.progressBar=s,s.setValue=function(e){this.setAttribute("aria-valuenow",e),s.setAttribute("aria-valuetext",t.applyReplaceStrings(t.langTerms.progressBarText));let n=e/parseFloat(this.getAttribute("aria-valuemax"))*100;n<1&&(n=1),s.style="width: "+n+"%;"},s.setMaxValue=function(e){if(e!==parseFloat(s.getAttribute("aria-valuemax"))){this.setAttribute("aria-valuemax",e);const t=parseFloat(this.getAttribute("aria-valuenow"))/e*100;s.style="width: "+t+"%;"}},n.appendChild(s),n},t.createStrikesElem=function(e){const n=document.createElement("div");return n.classList.add("strikes"),n.setAttribute("role","progressbar"),n.setAttribute("aria-valuemin","0"),n.overall=e,t.pageElements.strikeZone=n,n.setValue=function(e){n.setAttribute("aria-valuenow",e),n.setAttribute("aria-valuetext",t.applyReplaceStrings(t.langTerms.strikeZoneText));const s=n.querySelectorAll(".strike");for(let t=0;t<s.length;t++)t<e?s[t].classList.remove("faded"):s[t].classList.add("faded")},n.setMaxValue=function(e){let t;n.setAttribute("aria-valuemax",e),n.innerHTML="";for(let s=0;s<e;s++)(t=document.createElement("span")).classList="icon strike faded",t.setAttribute("aria-hidden","true"),n.appendChild(t)},n},t.applyReplaceStrings=function(e){let t="";if(!1!==e){let n;t=e;for(let e=0;e<this.replaceStrings.length;e++)n=new RegExp(this.replaceStrings[e],"g"),t.indexOf(this.replaceStrings[e])>=0&&(t=t.replace(n,this.getReplaceString(this.replaceStrings[e])))}return t},t.getReplaceString=function(e){let t;switch(e){case"#{currentPool}":t=this.sessionData.currentPool.poolName;break;case"#{upgradePool}":let n=this.getQuestionPoolById(this.sessionData.currentPool.upgradePoolId);t=!1!==n?n.poolName:"N/A";break;case"#{downgradePool}":let s=this.getQuestionPoolById(this.sessionData.currentPool.downgradePoolId);t=!1!==s?s.poolName:"N/A";break;case"#{numRemainingToUpgrade}":t="{numRemainingToUpgrade}",this.hasProperty(this.sessionData.currentPool.numWrongBeforeDowngrade)&&(t=this.sessionData.currentPool.numRightBeforeUpgrade-this.sessionData.currentPool.correctlyAnswered.length);break;case"#{numRemainingToDowngrade}":t="{numRemainingToDowngrade}",this.hasProperty(this.sessionData.currentPool.numWrongBeforeDowngrade)&&(t=this.sessionData.currentPool.numWrongBeforeDowngrade-this.sessionData.currentPool.incorrectlyAnswered.length);break;case"#{quizName}":t="{quizName}",this.hasProperty(this.pageElements.heading)&&(t=this.pageElements.heading.innerHTML);break;case"#{endingLevel}":t="{endingLevel}",this.hasProperty(this.sessionData.lastPool.poolName)&&(t=this.sessionData.lastPool.poolName);break;case"#{highestLevelAchieved}":t=this.hasProperty(this.sessionData.highestPoolAchieved)?this.sessionData.highestPoolAchieved:this.sessionData.lastPool.poolName}return t},t.loadFirstPage=function(){let n=this.quizData,s=this.pageElements,i=n.endConditions,o=this.sessionData;n.quizHeading&&(s.heading=this.appendHtml(n.quizHeading,this.parentElement,"heading")),this.createProgressArea(),this.createQuestionArea(),s.nextButton=this.createButton(function(){iatData[e].openNextPage(e)},t.langTerms.nextButton,s.questionArea.id),s.restartButton=this.createButton(function(){iatData[e].restartQuiz(iatData[e].quizDataUrl,e)},t.langTerms.restartButton,s.questionArea.id),s.checkAnswerButton=this.createButton(function(t){iatData[e].checkAnswer(t.target)},t.langTerms.checkAnswerButton,s.questionArea.id),s.showFeedbackButton=this.createButton(function(){iatData[e].generateFeedbackReportElem()},t.langTerms.showFeedbackButton,s.questionArea.id),s.showFeedbackButton.disable=function(){s.showFeedbackButton.classList.add("disabled"),s.showFeedbackButton.setAttribute("aria-disabled","true"),s.showFeedbackButton.removeAttribute("tabindex"),s.showFeedbackButton.onclick=null};let a=this.createHintBoxElem();if(a.hide(),s.hintButton=this.createButton(function(){iatData[e].toggleHint()},t.langTerms.hintButton,s.hintBox.id),s.restartButton.hide(),s.checkAnswerButton.hide(),s.hintButton.hide(),s.showFeedbackButton.hide(),s.checkAnswerButton.disable(),s.nextButton.disable(),s.restartButton.disable(),s.hintButton.disable(),n.showPoolName&&(s.questionPoolName=this.createQuestionPoolNameElement(n.questionPools[0].poolName),s.progressArea.sectionOne.appendChild(s.questionPoolName)),n.showStrikes){let e=!1;this.hasProperty(i.numQuestionsIncorrectToEnd.enabled)&&this.hasProperty(i.numQuestionsIncorrectToEnd.useForStrikes)&&(e=!0),s.progressArea.sectionTwo.appendChild(this.createStrikesElem(e))}if(n.showProgressBar){let e=!1;this.hasProperty(i.numQuestionsCorrectToEnd.enabled)&&this.hasProperty(i.numQuestionsCorrectToEnd.useForProgressBar)&&(e=!0);let t=this.createProgressBarElem(e);s.progressArea.sectionOne.appendChild(t),n.showPoolName&&s.questionPoolName.classList.add("less-spacing")}if(this.hasProperty(n.preQuizHtml)||this.hasVisibleEndConditions(n)){const e=this.generatePreQuizElem(n);s.questionArea.appendChild(e),o.currentPageType=this.specialPages.PRE_QUIZ,s.nextButton.enable(),s.progressArea.hide()}else o.currentQuestion=this.getFirstQuestion(),o.currentPageType=o.currentQuestion.questionType,this.showQuestion(o.currentQuestion,s.questionArea);s.buttonZone=document.createElement("div"),s.buttonZone.classList.add("button-zone"),s.buttonZone.appendChild(s.nextButton),s.buttonZone.appendChild(s.checkAnswerButton),s.buttonZone.appendChild(s.restartButton),s.buttonZone.appendChild(s.hintButton),s.buttonZone.appendChild(s.showFeedbackButton),this.parentElement.appendChild(s.buttonZone),this.parentElement.appendChild(a)},t.toggleHint=function(){this.pageElements.hintBox.toggle()},t.generatePreQuizElem=function(e){const t=document.createElement("div");let n,s,i;return this.hasProperty(e.preQuizHtml)&&((n=document.createElement("div")).innerHTML=e.preQuizHtml,t.appendChild(n)),this.hasProperty(e.endConditions.preface)&&((n=document.createElement("div")).classList.add("end-conditions"),n.innerHTML=e.endConditions.preface,t.appendChild(n)),n=document.createElement("div"),this.hasProperty(e.endConditions.numQuestionsCorrectToEnd.enabled)&&this.hasProperty(e.endConditions.numQuestionsCorrectToEnd.preQuizText)&&(s=document.createElement("ul"),(i=document.createElement("li")).innerHTML=e.endConditions.numQuestionsCorrectToEnd.preQuizText,s.appendChild(i)),this.hasProperty(e.endConditions.numQuestionsIncorrectToEnd.enabled)&&this.hasProperty(e.endConditions.numQuestionsIncorrectToEnd.preQuizText)&&(void 0===s&&(s=document.createElement("ul")),(i=document.createElement("li")).innerHTML=e.endConditions.numQuestionsIncorrectToEnd.preQuizText,s.appendChild(i)),this.hasProperty(e.endConditions.noRemainingQuestionsAtCurrentPool.enabled)&&this.hasProperty(e.endConditions.noRemainingQuestionsAtCurrentPool.preQuizText)&&(void 0===s&&(s=document.createElement("ul")),(i=document.createElement("li")).innerHTML=e.endConditions.noRemainingQuestionsAtCurrentPool.preQuizText,s.appendChild(i)),void 0!==s&&s.hasChildNodes()&&(n.appendChild(s),t.appendChild(n)),t},t.hasVisibleEndConditions=function(e){return!(!this.hasProperty(e.endConditions.numQuestionsCorrectToEnd.enabled)||!this.hasProperty(e.endConditions.numQuestionsCorrectToEnd.preQuizText))||(!(!this.hasProperty(e.endConditions.numQuestionsIncorrectToEnd.enabled)||!this.hasProperty(e.endConditions.numQuestionsIncorrectToEnd.preQuizText))||!(!this.hasProperty(e.endConditions.noRemainingQuestionsAtCurrentPool.enabled)||!this.hasProperty(e.endConditions.noRemainingQuestionsAtCurrentPool.preQuizText)))},t.createButton=function(e,t,n=!1,s=!1){t=this.applyReplaceStrings(t);const i=document.createElement("span");return i.setAttribute("role","button"),i.classList.add("btn"),!1!==s&&i.classList.add(s),!1!==n&&i.setAttribute("aria-controls",n),i.updateButton=function(e,t){void 0!==t&&(this.innerHTML=t),this.onclick=e,this.onkeypress=function(t){13!==t.keyCode&&32!==t.keyCode||e(t)}},i.hide=function(){i.classList.add("hidden"),i.setAttribute("aria-hidden","true")},i.show=function(){i.classList.remove("hidden"),i.setAttribute("aria-hidden","false")},i.enable=function(){i.classList.remove("disabled"),i.setAttribute("aria-disabled","false"),i.tabIndex=0},i.disable=function(){i.classList.add("disabled"),i.setAttribute("aria-disabled","true"),i.removeAttribute("tabindex")},i.updateButton(e,t),i},t.createProgressArea=function(){const e=document.createElement("div");e.classList.add("progress-area"),this.hasProperty(this.quizData.quizHeading)||e.classList.add("no-heading");const t=document.createElement("span");t.classList.add("section-1");const n=document.createElement("span");n.classList.add("section-2"),e.hide=function(){this.setAttribute("aria-hidden","true"),this.classList.add("hidden")},e.show=function(){this.setAttribute("aria-hidden","false"),this.classList.remove("hidden")},e.appendChild(t),e.appendChild(n),this.pageElements.progressArea=e,this.pageElements.progressArea.sectionOne=t,this.pageElements.progressArea.sectionTwo=n,this.parentElement.appendChild(e)},t.createQuestionArea=function(){this.pageElements.questionArea=document.createElement("div"),this.pageElements.questionArea.classList.add("question-area"),this.pageElements.questionArea.id="question-area",this.pageElements.questionArea.setAttribute("role","region"),this.pageElements.questionArea.setAttribute("aria-live","assertive"),this.parentElement.appendChild(this.pageElements.questionArea)},t.getQuestionPoolById=function(e){let t=!1,n=this.quizData.questionPools;for(let s=0;s<n.length;s++)if(n[s].poolId===e){t=n[s];break}return t},t.getFirstQuestion=function(){return this.setCurrentPool(this.quizData.questionPools[0].poolId),this.quizData.questionPools[0].questions.pop()},t.randomizeOptions=function(e){const t=e.element.querySelector(".options-container");for(let e=t.children.length;e>=0;e--)t.appendChild(t.children[Math.random()*e|0])},t.createQuestionPoolNameElement=function(e=""){let t=document.createElement("div");return t.classList.add("pool-name"),t.innerHTML=e,t.show=function(){t.classList.remove("hidden"),t.setAttribute("aria-hidden","false")},t.hide=function(){t.classList.add("hidden"),t.setAttribute("aria-hidden","true")},t},t.setQuestionPoolName=function(e){this.pageElements.questionPoolName.innerHTML=e},t.randomizeQuestionPool=function(e){this.shuffle(e.questions)},t.shuffle=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e},t.generateQuestionElem=function(e){return e.questionType===this.specialPages.MULTIPLE_CHOICE?this.createMultipleChoiceElem(e):e.questionType===this.specialPages.MULTI_SELECT?this.createMultiSelectElem(e):e.questionType===this.specialPages.FILL_IN_THE_BLANK?this.createFillInTheBlankElem(e):e.questionType===this.specialPages.MATCHING?this.createMatchingElem(e):void 0},t.loadQuizData=function(e,t,n){const s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&200===s.status&&(this.quizData=JSON.parse(s.responseText),n())},s.open("GET",e,!0),s.send()},t.augmentQuizData=function(){const e=this.quizData.questionPools;for(let t=0;t<e.length;t++){e[t].id=t,e[t].correctlyAnswered=[],e[t].incorrectlyAnswered=[],e[t].numCorrectlyAnswered=0,e[t].numIncorrectlyAnswered=0,e[t].numCorrectlyAnsweredOverall=0,e[t].numIncorrectlyAnsweredOverall=0;for(let n=0;n<e[t].questions.length;n++)e[t].questions[n].element=null,e[t].questions[n].id="q_"+t+"_"+n,this.standardizeQuestionType(e[t].questions[n])}},t.getQuestionPoolName=function(e){for(let t=0;t<this.quizData.questionPools.length;t++)if(this.quizData.questionPools[t].id===e)return this.quizData.questionPools[t].poolName;return!1},t.getQuestionById=function(e){let t=this.quizData.questionPools;for(let n=0;n<t.length;n++){for(let s=0;s<t[n].questions.length;s++)if(t[n].questions[s].id===e)return t[n].questions[s];for(let s=0;s<t[n].correctQuestions.length;s++)if(t.correctQuestions[s].id===e)return t[n].correctQuestions[s];for(let s=0;s<t[n].incorrectQuestions.length;s++)if(t.incorrectQuestions[s].id===e)return t[n].incorrectQuestions[s]}return!1},t.createMultipleChoiceElem=function(e){const n=document.createElement("div");n.innerHTML=e.questionHtml;const s=document.createElement("div");let i,o,a;s.setAttribute("role","radiogroup"),s.classList.add("options-container");for(let n=0;n<e.options.length;n++)e.options[n].id=e.id+"_"+n,(i=document.createElement("div")).setAttribute("role","radio"),i.id=e.options[n].id,i.setAttribute("aria-checked","false"),i.disable=function(){this.classList.add("disabled"),this.setAttribute("aria-disabled","true"),this.removeAttribute("tabindex"),this.onclick=null,this.onkeypress=null},i.enable=function(){this.classList.remove("disabled"),this.removeAttribute("aria-disabled"),this.setAttribute("tabindex","0");let e=function(e){const n=e.target.closest("[role=radiogroup]").querySelectorAll(".selected");for(let e=0;e<n.length;e++)n[e].classList.remove("selected"),n[e].setAttribute("aria-checked","false");"SPAN"===e.target.nodeName?(e.target.parentElement.classList.add("selected"),e.target.parentElement.setAttribute("aria-checked","true")):(e.target.classList.add("selected"),e.target.parentElement.setAttribute("aria-checked","true")),t.pageElements.checkAnswerButton.enable()};this.onclick=e,this.onkeypress=function(t){13!==t.keyCode&&32!==t.keyCode||e(t)}},i.enable(),(o=document.createElement("span")).classList.add("selectable-button"),o.classList.add("radio"),(a=document.createElement("span")).innerHTML=e.options[n].optionText,i.appendChild(o),i.appendChild(a),s.appendChild(i);const r=document.createElement("div");return r.appendChild(n),r.appendChild(s),r.id=e.id,r.randomizeOptions=function(){t.randomizeOptions(e)},r},t.disableMcOptions=function(e){const t="#"+e.id+" div[role=radio]",n=this.parentElement.querySelectorAll(t);for(let e=0;e<n.length;e++)n[e].disable()},t.selectMcOption=function(){const e=this.closest("[role=radiogroup]").querySelectorAll(".selected");for(let t=0;t<e.length;t++)e[t].classList.remove("selected");this.classList.add("selected"),this.setAttribute("aria-checked","true"),this.pageElements.checkAnswerButton.enable()},t.createMultiSelectElem=function(e){const n=document.createElement("div");n.innerHTML=e.questionHtml;const s=document.createElement("div");let i,o,a;s.setAttribute("role","checkboxgroup"),s.classList.add("options-container");for(let t=0;t<e.options.length;t++)e.options[t].id=e.id+"_"+t,(i=document.createElement("div")).setAttribute("role","checkbox"),i.id=e.options[t].id,i.disable=function(){this.classList.add("disabled"),this.setAttribute("aria-disabled","true"),this.removeAttribute("tabindex"),this.onclick=null,this.onkeypress=null},i.enable=function(){this.classList.remove("disabled"),this.removeAttribute("aria-disabled"),this.setAttribute("tabindex","0");let e=function(e){let t=e.target;"checkbox"!==e.target.getAttribute("role")&&(t=e.target.closest('[role="checkbox"]')),t.classList.contains("selected")?(t.classList.remove("selected"),t.setAttribute("aria-checked","false")):(t.classList.add("selected"),t.setAttribute("aria-checked","true"))};this.onclick=e,this.onkeypress=function(t){13!==t.keyCode&&32!==t.keyCode||e(t)}},i.enable(),(o=document.createElement("span")).classList.add("selectable-button"),o.classList.add("checkbox"),(a=document.createElement("span")).innerHTML=e.options[t].optionText,i.appendChild(o),i.appendChild(a),s.appendChild(i);const r=document.createElement("div");return r.appendChild(n),r.appendChild(s),r.id=e.id,r.randomizeOptions=function(){t.randomizeOptions(e)},t.pageElements.checkAnswerButton.enable(),r},t.disableMsOptions=function(e){const t="#"+e.id+" div[role=checkbox]",n=this.parentElement.querySelectorAll(t);for(let e=0;e<n.length;e++)n[e].disable()},t.selectMsOption=function(){const e=this.closest("[role=radiogroup]").querySelectorAll(".selected");for(let t=0;t<e.length;t++)e[t].classList.remove("selected");this.classList.add("selected"),this.pageElements.checkAnswerButton.enable()},t.createFillInTheBlankElem=function(e){const n=document.createElement("div");let s,i,o,a=e.blanks,r="",l=e.questionHtml;for(let e=0;e<a.length;e++)s=a[e],this.isNumber(s.size)&&(r+=' size="'+s.size+'"'),this.isNumber(s.maxLength)&&(r+=' maxlength="'+s.maxLength+'"'),i='<input data-blank="'+s.replaceString+'" type="text"'+r+"></input>",o=new RegExp(s.replaceString,"g"),l=l.replace(o,i);n.innerHTML=l;const c=document.createElement("div");c.appendChild(n),c.id=e.id;const u=c.querySelector("input");return null===u?n.innerHTML="Couldn't find a blank replace string in the question's data file. Make sure a replace string is defined and used.":u.addEventListener("input",function(e){""!==e.target.value.trim()?t.pageElements.checkAnswerButton.enable():t.pageElements.checkAnswerButton.disable()}),c.disableQuestion=function(){t.disableFitb(e)},c.enableQuestion=function(){t.enableFitb(e)},c},t.disableFitb=function(e){const t="#"+e.id+" input[type=text]",n=this.parentElement.querySelectorAll(t);for(let e=0;e<n.length;e++)n[e].setAttribute("disabled","disabled"),n[e].setAttribute("aria-disabled","true"),n[e].classList.add("pr-30px")},t.enableFitb=function(e){const t="#"+e.id+" input[type=text]",n=this.parentElement.querySelectorAll(t);for(let e=0;e<inputsToDisable.length;e++)n[e].removeAttribute("disabled"),n[e].setAttribute("aria-disabled","false"),n[e].classList.remove("pr-30px")},t.createMatchingElem=function(e){const n=document.createElement("div");n.classList.add("matching"),this.hasProperty(e.questionHtml)&&(n.innerHTML=e.questionHtml);const s=document.createElement("select");let i=document.createElement("option");i.selected=!0,i.value="none",i.dataset.id="none",s.appendChild(i);const o=[];o.hasOption=function(e){for(let t=0;t<o.length;t++)if(o[t].value==e)return!0;return!1};for(let t=0;t<e.options.length;t++)this.hasProperty(e.options[t].matchingText)&&!o.hasOption(e.options[t].matchingText)?((i=document.createElement("option")).dataset.id=e.id+"_"+t,i.innerHTML=e.options[t].matchingText,i.value=e.options[t].matchingText,o.push(i)):e.hasEmptyAnswers=!0;let a,r,l;o.sort(function(e,t){const n=e.value.toLocaleLowerCase(),s=t.value.toLocaleLowerCase();return s>n?-1:n>s?1:0}).forEach(function(e){s.appendChild(e)});for(let i=0;i<e.options.length;i++)(a=document.createElement("div")).id=e.id+"_"+i,(r=document.createElement("span")).innerHTML=e.options[i].optionText,(l=s.cloneNode(!0)).setAttribute("aria-label",e.options[i].optionText),l.onchange=function(){t.checkAllComboBoxes(e)?t.pageElements.checkAnswerButton.enable():t.pageElements.checkAnswerButton.disable()},l.enable=function(){this.setAttribute("aria-disabled","false"),this.removeAttribute("disabled"),this.classList.remove("disabled")},l.disable=function(){this.setAttribute("aria-disabled","true"),this.disabled="disabled",this.classList.add("disabled")},a.appendChild(l),a.appendChild(r),n.appendChild(a);const c=document.createElement("div");return c.appendChild(n),c.id=e.id,c.randomizeOptions=function(){let e=this.querySelector(".matching"),t=e.querySelectorAll("div");for(let n=0;n<t.length;n++)e.appendChild(t[Math.random()*n|0])},c.disableQuestion=function(){const e=this.querySelectorAll("select");for(let t=0;t<e.length;t++)e[t].disable()},c},t.checkAllComboBoxes=function(e){if(this.hasProperty(e.hasEmptyAnswers))return!0;{const t="#"+e.id+" select",n=this.parentElement.querySelectorAll(t);for(let e=0;e<n.length;e++)if("none"===n[e].options[n[e].options.selectedIndex].dataset.id)return!1;return!0}},t.showQuestionFeedback=function(e,t){const n=this.parentElement.querySelector("#"+t),s=document.createElement("div");s.classList.add("feedback"),this.hasProperty(this.quizData.colouredFeedback)&&(e.score>0?s.classList.add("green"):s.classList.add("red")),s.innerHTML=this.applyReplaceStrings(e.text),n.appendChild(s)},t.openNextPage=function(e){this.clearStage();let t=this.sessionData.currentPool,n=!1,s=!1,i=!1,o=!1;this.sessionData.currentPageType===this.specialPages.PRE_QUIZ&&(n=this.getFirstQuestion()),this.checkEndConditions()&&(s=this.applyReplaceStrings(this.quizData.postQuizHtml),i=this.specialPages.POST_QUIZ,n=!1,o=!0);let a=!1;if(o||n||!this.readyToUpgrade(t)){if(!o&&!n&&this.readyToDowngrade(t)){const e=t.feedbackOnDowngradeHtml;let r=this.pageElements.progressArea.cloneNode(!0);this.hasProperty(t.downgradePoolId)?(t=this.setCurrentPool(t.downgradePoolId),this.hasProperty(e)?(s=r.outerHTML+this.applyReplaceStrings(e),i=this.specialPages.DOWNGRADE_FEEDBACK):n=this.getNextQuestion(),a=!0):(this.hasProperty(this.quizData.postQuizHtml)&&(s=this.applyReplaceStrings(this.quizData.postQuizHtml)),i=this.specialPages.POST_QUIZ,n=!1,o=!0)}}else{const e=t.feedbackOnUpgradeHtml;let r=this.pageElements.progressArea.cloneNode(!0);this.hasProperty(t.upgradePoolId)?(null!==this.sessionData.highestPoolAchieved&&t.poolLevel>=this.sessionData.highestPoolAchieved.poolLevel&&(this.sessionData.highestPoolAchieved=t),this.sessionData.highestPoolAchieved=t,t=this.setCurrentPool(t.upgradePoolId),this.hasProperty(e)?(s=r.outerHTML+this.applyReplaceStrings(e),i=this.specialPages.UPGRADE_FEEDBACK):n=this.getNextQuestion(),a=!0):(this.hasProperty(this.quizData.postQuizHtml)&&(s=this.applyReplaceStrings(this.quizData.postQuizHtml)),i=this.specialPages.POST_QUIZ,n=!1,o=!0)}if(!o&&!n&&!a){t.repeatCorrect&&0===t.questions.length&&(this.removeCalculatedFeedback(t.correctlyAnswered,e),t.questions=this.joinArrays(t.questions,t.correctlyAnswered)),t.repeatWrong&&0===t.questions.length&&(this.removeCalculatedFeedback(t.incorrectlyAnswered,e),t.questions=this.joinArrays(t.questions,t.incorrectlyAnswered));let o=this.hasProperty(this.quizData.endConditions.noRemainingQuestionsAtCurrentPool.enabled);!t||0===t.questions.length&&(o||!t.repeatWrong&&!t.repeatCorrect)?(i=this.specialPages.POST_QUIZ,s=this.applyReplaceStrings(this.quizData.postQuizHtml)):(this.shuffle(t.questions),n=this.getNextQuestion())}!1!==n&&(s=n.questionHtml,i=n.questionType);const r={question:n,html:s,type:i};this.openPage(r)},t.joinArrays=function(e,t){const n=e;for(;t.length>0;)n.push(t.pop());return n},t.removeCalculatedFeedback=function(e,t){e.forEach(function(e){iatData[t].hasProperty(e.calculatedFeedback)&&(e.calculatedFeedback=null,iatData[t].removeUiFeedback(e))})},t.openPage=function(e){this.sessionData.currentQuestion=e.question,this.sessionData.currentPageType=e.type;const n=this.pageElements,s=this.sessionData;if(e.question){if(null!==n.progressBar){let e=s.currentPool.numCorrectlyAnswered;this.hasProperty(n.progressBar.overall)&&(e=this.getOverallProgress()),n.progressBar.setValue(e)}null===n.strikeZone&&null===n.progressBar&&null===n.questionPoolName||n.progressArea.show(),this.showQuestion(e.question,n.questionArea)}else null===n.strikeZone&&null===n.progressBar&&null===n.questionPoolName||n.progressArea.hide(),this.hasProperty(e.html)&&this.appendHtml(e.html,n.questionArea),e.type===this.specialPages.POST_QUIZ&&(n.nextButton.hide(),n.restartButton.show(),n.restartButton.enable(),this.hasProperty(this.quizData.showFeedbackReport)&&n.showFeedbackButton.show());t.triggerHeightReset()},t.setCurrentPool=function(e){const n=this.sessionData;if(n.currentPool=this.getQuestionPoolById(e),n.currentPool.numCorrectlyAnswered=0,n.currentPool.numIncorrectlyAnswered=0,this.parentElement.setAttribute("data-pool-id",e),n.currentPool&&t.restoreQuestions(n.currentPool),this.isNumber(e)&&(n.lastPool=n.currentPool),this.quizData.showPoolName&&this.setQuestionPoolName(n.currentPool.poolName),this.quizData.showStrikes){const e=this.pageElements.strikeZone;let t,s;e.overall?(s=this.getOverallIncorrect(),t=this.quizData.endConditions.numQuestionsIncorrectToEnd.limit):(s=0,t=n.currentPool.numWrongBeforeDowngrade),e.setMaxValue(t),e.setValue(s)}if(this.quizData.showProgressBar){const e=this.pageElements.progressBar;let t,s;this.hasProperty(e.overall)?(s=this.getOverallProgress(),t=this.quizData.endConditions.numQuestionsCorrectToEnd.limit):(s=n.currentPool.numCorrectlyAnswered,t=n.currentPool.numRightBeforeUpgrade),e.setValue(s),e.setMaxValue(t)}return n.currentPool.randomizeQuestionOrder&&this.randomizeQuestionPool(n.currentPool),n.currentPool},t.setNextPool=function(e){return this.sessionData.nextPool=this.getQuestionPoolById(e),this.sessionData.nextPool},t.readyToUpgrade=function(e){return!!(this.isNumber(e.numRightBeforeUpgrade)&&e.numCorrectlyAnswered>=e.numRightBeforeUpgrade)},t.readyToDowngrade=function(e){return!!(this.isNumber(e.numWrongBeforeDowngrade)&&e.numIncorrectlyAnswered>=e.numWrongBeforeDowngrade)},t.getNextQuestion=function(){let e=this.sessionData.currentPool,t=!1;return 0!==e.questions.length&&(t=e.questions.pop()),t},t.hasProperty=function(e){return null!=e&&!1!==e&&"none"!==e},t.isNumber=function(e){let t=!1;return Number(parseFloat(e))===e&&(t=!0),t},t.openPreviousQuestion=function(){},t.initializeData=function(){},t.restartQuiz=function(e,t){document.getElementById(t).innerHTML="",window.loadAdaptiveQuiz(e,t)},t.showQuestion=function(e,t){null!==e.element&&void 0!==e.element||(e.element=this.generateQuestionElem(e)),e.randomizeOptions&&e.element.randomizeOptions(),this.hasProperty(e.hintHtml)?(this.pageElements.hintBox.setContent(e.hintHtml),this.pageElements.hintButton.show(),this.pageElements.hintButton.enable()):(this.pageElements.hintBox.setContent(""),this.pageElements.hintButton.hide(),this.pageElements.hintButton.disable()),this.pageElements.nextButton.hide(),this.pageElements.checkAnswerButton.show(),(this.hasProperty(e.hasEmptyAnswers)||e.questionType===this.specialPages.MULTI_SELECT)&&this.pageElements.checkAnswerButton.enable(),this.sessionData.currentQuestion=e,t.appendChild(e.element)},t.restoreQuestions=function(e){let n;for(;e.incorrectlyAnswered.length>0;)n=e.incorrectlyAnswered.pop(),t.removeUiFeedback(n),e.questions.push(n);for(;e.correctlyAnswered.length>0;)n=e.correctlyAnswered.pop(),t.removeUiFeedback(n),e.questions.push(n)},t.checkAnswer=function(e){if(e.classList.contains("disabled"))return!1;const t=this.sessionData.currentQuestion;let n={text:"",score:0};t.questionType===this.specialPages.MULTIPLE_CHOICE?n=this.checkMultipleChoiceAnswer(t):t.questionType===this.specialPages.MULTI_SELECT?n=this.checkMultiSelectAnswer(t):t.questionType===this.specialPages.FILL_IN_THE_BLANK?n=this.checkFillInTheBlankAnswer(t):t.questionType===this.specialPages.MATCHING&&(n=this.checkMatchingAnswer(t));const s=this.sessionData.currentPool;if(n.score>=1)s.correctlyAnswered.push(t),s.numCorrectlyAnswered++,s.numCorrectlyAnsweredOverall++;else if(s.incorrectlyAnswered.push(t),s.numIncorrectlyAnswered++,s.numIncorrectlyAnsweredOverall++,this.quizData.showStrikes){let e=s.numIncorrectlyAnswered;this.pageElements.strikeZone.overall&&(e=this.getOverallIncorrect()),this.pageElements.strikeZone.setValue(e)}if(this.hasProperty(this.quizData.showFeedbackReport)&&this.addQuestionToReport(t,s.poolName,n),null!==this.pageElements.progressBar){let e=this.sessionData.currentPool.numCorrectlyAnswered;this.hasProperty(this.pageElements.progressBar.overall)&&(e=this.getOverallProgress()),this.pageElements.progressBar.setValue(e)}t.calculatedFeedback=n,this.showQuestionFeedback(n,t.id),this.disableQuestion(t),this.pageElements.checkAnswerButton.hide(),this.pageElements.checkAnswerButton.disable(),this.pageElements.nextButton.show(),this.pageElements.nextButton.enable()},t.disableQuestion=function(e){const t=this.specialPages;e.questionType===t.MULTIPLE_CHOICE&&this.disableMcOptions(e),e.questionType===t.MULTI_SELECT&&this.disableMsOptions(e),e.questionType===t.FILL_IN_THE_BLANK&&e.element.disableQuestion(),e.questionType===t.MATCHING&&e.element.disableQuestion()},t.standardizeQuestionType=function(e){let t=e.questionType.toLowerCase();["multiple choice","mc","true false","tf"].includes(t)&&(t=this.specialPages.MULTIPLE_CHOICE);["multi-select","ms","multiselect","all that apply","ata"].includes(t)&&(t=this.specialPages.MULTI_SELECT);["fill in the blank","fitb","fill"].includes(t)&&(t=this.specialPages.FILL_IN_THE_BLANK);["ordering","ord","order","matching","match","sort","sorting"].includes(t)&&(t=this.specialPages.MATCHING),e.questionType=t},t.checkMultipleChoiceAnswer=function(e){const t=this.parentElement.querySelector("#"+e.id+" .selected"),n={text:"",score:0};for(let s=0;s<e.options.length;s++)void 0!==e.options[s].score&&e.options[s].score>0&&(t.id===e.options[s].id?t.classList.add("checkmark"):(t.classList.add("cross"),this.parentElement.querySelector("#"+e.options[s].id).classList.add("arrow"))),e.options[s].id===t.id&&(n.text=e.options[s].feedback,n.score=this.hasProperty(e.options[s].score),n.score||(n.score=0));return this.addFeedbackIcons(),n},t.checkMultiSelectAnswer=function(e){let n=function(e,n){let s=0;for(let t=0;t<e.options.length;t++)e.options[t].id===n&&(s=e.options[t].score);return t.isNumber(s)?s:0};const s=this.parentElement.querySelectorAll("#"+e.id+" div[role=checkbox]"),i={text:"",score:0};let o=1;for(let t=0;t<s.length;t++){let i=n(e,s[t].id);s[t].classList.contains("selected")?i>0?s[t].classList.add("checkmark"):(s[t].classList.add("cross"),o=0):i>0&&(s[t].classList.add("arrow"),s[t].classList.add("cross"),o=0)}return"report"!==this.quizData.feedbackType.toLowerCase()&&this.addFeedbackIcons(),i.score=o,i.text=0===o?e.feedbackForImperfect:e.feedbackForPerfect,i},t.checkFillInTheBlankAnswer=function(e){const t=this.parentElement.querySelectorAll("#"+e.id+" input");let n;if(!e.caseSensitive)for(let t=0;t<e.blanks.length;t++)for(let n=0;n<e.blanks[t].answers.length;n++)e.blanks[t].answers[n]=e.blanks[t].answers[n].toString().toLocaleLowerCase();const s={text:e.feedbackForPerfect,score:1};let i,o,a,r;for(let l=0;l<t.length;l++)i=t[l].getAttribute("data-blank"),n=t[l].value,e.caseSensitive||(n=n.toString().toLocaleLowerCase()),o=(a=e.blanks.filter(e=>e.replaceString===i))[0].answers,(r=document.createElement("span")).classList.add("abs"),-1!==o.indexOf(n)?r.classList.add("checkmark"):(r.classList.add("cross"),s.score=0,s.text=e.feedbackForImperfect),t[l].insertAdjacentElement("afterend",r);return this.addFeedbackIcons(),s},t.checkMatchingAnswer=function(e){const t={text:e.feedbackForPerfect,score:1};let n,s,i,o,a;for(let r=0;r<e.options.length;r++)o=e.id+"_"+r,i=(s=(n=this.parentElement.querySelector("#"+o)).querySelector("select").options)[s.selectedIndex].dataset.id,s[s.selectedIndex].setAttribute("selected","selected"),s[s.selectedIndex].setAttribute("aria-selected","true"),a=s[s.selectedIndex].value,this.hasProperty(e.options[r].matchingText)?a!==e.options[r].matchingText.toString()?(t.score=0,t.text=e.feedbackForImperfect,n.classList.add("cross")):n.classList.add("checkmark"):"none"===i?n.classList.add("checkmark"):n.classList.add("cross");return this.addFeedbackIcons(),t},t.addQuestionToReport=function(e,t,n){const s=JSON.parse(JSON.stringify(e));s.element=e.element.cloneNode(!0),s.element.removeAttribute("id"),s.poolName=t,s.feedback=n;const i=s.element.querySelectorAll('input,div[role="radio"],div[role="checkbox"],select');for(let e=0;e<i.length;e++)i[e].classList.add("disabled"),i[e].setAttribute("aria-disabled","true"),i[e].setAttribute("disabled","disabled"),i[e].hasAttribute("data-blank")&&i[e].classList.add("pr-30px");this.sessionData.feedbackReportQuestions.push(s)},t.generateFeedbackReportElem=function(){this.pageElements.showFeedbackButton.disable();const e=document.createElement("div");e.classList.add("feedback-report");const t=this.sessionData.feedbackReportQuestions;let n,s,i;for(let o=0;o<t.length;o++)0!==o&&t[o].poolName===t[o-1].poolName||((n=document.createElement("div")).classList="pool-name",n.innerHTML=t[o].poolName,e.appendChild(n)),(s=t[o].element).classList.add("question"),e.appendChild(s),this.hasProperty(t[o].feedback)&&((i=document.createElement("div")).classList.add("feedback"),i.innerHTML=t[o].feedback.text,e.appendChild(i));this.parentElement.appendChild(e)},t.addFeedbackIcons=function(){let e,t=this.parentElement.querySelectorAll(".cross"),n=this.parentElement.querySelectorAll(".checkmark"),s=this.parentElement.querySelectorAll(".arrow");for(e=0;e<t.length;e++)t[e].classList.add("icon-bg-cross");for(e=0;e<n.length;e++)n[e].classList.add("icon-bg-checkmark");for(e=0;e<s.length;e++)s[e].classList.add("icon-bg-arrow")},t.removeUiFeedback=function(e){const t=e.element;Array.from(t.getElementsByClassName("disabled")).forEach(function(e){e.enable()}),Array.from(t.getElementsByClassName("selected")).forEach(function(e){e.classList.remove("selected")}),Array.from(t.getElementsByClassName("arrow")).forEach(function(e){e.classList.remove("arrow"),e.classList.remove("icon-bg-arrow"),e.classList.contains("icon")&&e.parentNode.removeChild(e)}),Array.from(t.getElementsByClassName("cross")).forEach(function(e){e.classList.remove("cross"),e.classList.remove("icon-bg-cross"),e.classList.contains("icon")&&e.parentNode.removeChild(e)}),Array.from(t.getElementsByClassName("checkmark")).forEach(function(e){e.classList.remove("checkmark"),e.classList.remove("icon-bg-checkmark"),e.classList.contains("icon")&&e.parentNode.removeChild(e)}),Array.from(t.querySelectorAll("input")).forEach(function(e){e.value=""}),void 0!==e.element.enableQuestion&&e.element.enableQuestion(),Array.from(t.getElementsByClassName("feedback")).forEach(function(e){e.parentNode.removeChild(e)}),Array.from(t.querySelectorAll("select")).forEach(function(e){e.value="none"})},t.appendHtml=function(e,t,n=""){const s=document.createElement("span");return s.innerHTML=e,""!==n&&s.classList.add(n),t.appendChild(s),s},t.clearStage=function(){this.pageElements.questionArea.innerHTML="",this.pageElements.hintButton.hide(),this.pageElements.hintBox.hide()},t.checkEndConditions=function(){let e=[];e=this.quizData.endConditions;let t=!1;return this.hasProperty(this.quizData.showHighestLevelAchieved)&&this.getHighestLevelAchieved(this.quizData),!t&&this.hasProperty(e.numQuestionsCorrectToEnd.enabled)&&(t=this.checkNumCorrectToEnd()),!t&&this.hasProperty(e.numQuestionsIncorrectToEnd.enabled)&&(t=this.checkNumIncorrectToEnd()),t},t.checkNumCorrectToEnd=function(){let e=0;return this.quizData.questionPools.forEach(function(t){e+=t.numCorrectlyAnsweredOverall}),e>=this.quizData.endConditions.numQuestionsCorrectToEnd.limit},t.checkNumIncorrectToEnd=function(){let e=0;return this.quizData.questionPools.forEach(function(t){e+=t.numIncorrectlyAnsweredOverall}),e>=this.quizData.endConditions.numQuestionsIncorrectToEnd.limit},t.getOverallProgress=function(){let e=0;return this.quizData.questionPools.forEach(function(t){e+=t.numCorrectlyAnsweredOverall}),e},t.getOverallIncorrect=function(){let e=0;return this.quizData.questionPools.forEach(function(t){e+=t.numIncorrectlyAnsweredOverall}),e},t.getQuestionPoolProgress=function(e){return e.numCorrectlyAnswered/e.numRightBeforeUpgrade*100},t.getHighestLevelAchieved=function(e){let t=this.sessionData.highestLevelAchieved;e.questionPools.forEach(function(e){e.numCorrectlyAnswered>0&&e.poolLevel>t&&(this.sessionData.highestPoolAchieved=!1,this.sessionData.highestLevelAchieved=t)})},t.triggerHeightReset=function(e=!0){this.parentElement.removeAttribute("style"),this.parentElement.setAttribute("style","height: auto;"),e&&setTimeout(function(){t.triggerHeightReset(!1)},1e3)},t.giveIds(t.specialPages),t.augmentQuizData(),t.loadFirstPage()}window.hasOwnProperty("iatData")||(iatData={}),loadQuizData=function(e,t,n,s=null){if(null!==s)iatData[t].quizData=s,n();else{const s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===XMLHttpRequest.DONE)if(200===s.status)iatData[t].quizData=JSON.parse(s.responseText),n();else{const e=document.createElement("div");e.style="max-width: 100%; overflow: auto;";const n=document.createElement("p");n.innerHTML="The quiz could not be loaded because the data file could not be found.";const s=document.createElement("p");s.innerHTML="This URL to the data file is invalid: <br>"+this.responseURL,e.appendChild(n),e.appendChild(s),document.getElementById(t).appendChild(e)}},s.open("GET",e,!0),s.send()}},loadLanguageData=function(e,t){let n=iatData[e];if(null!==n.quizData.langTerms&&void 0!==n.quizData.langTerms&&!1!==n.quizData.langTerms)n.langTerms=n.quizData.langTerms,t();else{const e="lang/"+document.documentElement.lang+".txt",s=new XMLHttpRequest;s.onreadystatechange=function(){s.readyState===XMLHttpRequest.DONE&&(200===s.status?(n.langTerms=JSON.parse(s.responseText),t()):t())},s.open("GET",e,!0),s.send()}};